if(document.implementation.hasFeature("XPath","3.0")){if(typeof XMLDocument=="undefined")XMLDocument=Document;XMLDocument.prototype.selectNodes=function(e,b){if(!b)b=this;for(var f=this.createNSResolver(this.documentElement),d=this.evaluate(e,b,f,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),c=[],a=0;a<d.snapshotLength;a++)c[a]=d.snapshotItem(a);return c};XMLDocument.prototype.selectSingleNode=function(c,a){if(!a)a=this;var b=this.selectNodes(c,a);if(b.length>0)return b[0];else return null};Element.prototype.selectNodes=function(a){if(this.ownerDocument.selectNodes)return this.ownerDocument.selectNodes(a,this);else throw"For XML Elements Only";};Element.prototype.selectSingleNode=function(a){if(this.ownerDocument.selectSingleNode)return this.ownerDocument.selectSingleNode(a,this);else throw"For XML Elements Only";}};NHS.Scripts.CommunityResults.StateIndex=function(a){this._nhsMqMap;this._mqCenter;this._mqZoom;this._nhsMapIconShadow;this._nhsMapIconMkt;this._mapCenterLat;this._mapCenterLng;this._partnerId=a.partnerId;this._state=a.state;this._siteRoot=a.siteRoot;this._resourceRoot=a.resourceRoot;this._brandPartnerId=a.brandPartnerId;this._mapCenterLat=a.mqCenterLat;this._mapCenterLng=a.mqCenterLng;this._mqZoom=a.mqZoomLevel;this._mapStatesAction="/MapSearch/GetStateMarketMapPoints";if(this._brandPartnerId==333)this._mqIconMktPath=this._resourceRoot+"globalresources/move/images/map/marker_market.gif";else this._mqIconMktPath=this._resourceRoot+"globalresources/default/images/map/mkt_icon.gif";this._mqIconShadowPath=this._resourceRoot+"globalresources/default/images/map/marker_shadow.png"};NHS.Scripts.CommunityResults.StateIndex.prototype={initialize:function(){var a=document.getElementById("nhsStateIndexMap");if(this._mapCenterLat==null){a.style.display="none";return false}this._mqCenter=new MQA.LatLng(this._mapCenterLat,this._mapCenterLng);this._nhsMqMap=new MQA.TileMap(document.getElementById("nhsStateIndexMap"),this._mqZoom,this._mqCenter,"map");this._nhsMapIconShadow=new MQA.Icon(this._mqIconShadowPath,0,0);this._nhsMapIconMkt=new MQA.Icon(this._mqIconMktPath,40,37);var b=new MQA.ZoomControl;this._nhsMqMap.addControl(b,new MQA.MapCornerPlacement(MQA.MapCorner.TOP_LEFT,new MQA.Size(10,20)));a.style.border="1px solid #000";var d=a.offsetWidth-2+"px",c="400px";this._nhsMqMap.setSize(new MQA.Size(d,c));this._getStateMarketMapPois();$jq("#nhs_StateBrowseDiv0").css("display","none");$jq("#nhs_StateBrowseDiv1").css("display","none");$jq("#nhs_StateBrowseDiv2").css("display","none");$jq("#nhs_StateBrowseDiv").css("height","250px");$jq("#indexTab1").click(function(){this._switchBoxDisplay("li1","nhs_StateBrowseDiv3","nhs_StateBrowseDiv2","nhs_StateBrowseDiv1","nhs_StateBrowseDiv0");return false}.bind(this));$jq("#indexTab2").click(function(){this._switchBoxDisplay("li2","nhs_StateBrowseDiv2","nhs_StateBrowseDiv1","nhs_StateBrowseDiv3","nhs_StateBrowseDiv0");return false}.bind(this));$jq("#indexTab3").click(function(){this._switchBoxDisplay("li3","nhs_StateBrowseDiv1","nhs_StateBrowseDiv2","nhs_StateBrowseDiv3","nhs_StateBrowseDiv0");return false}.bind(this));$jq("#indexTab4").click(function(){this._switchBoxDisplay("li4","nhs_StateBrowseDiv0","nhs_StateBrowseDiv1","nhs_StateBrowseDiv2","nhs_StateBrowseDiv3");return false}.bind(this));$jq("#btnSearchHomes").click(function(){if($jq("#SelectedMarketId").val()=="0"){alert("Area is required.");return false}});$jq("div#nhs_StateBrowseDiv0 ul li").length==0&&$jq("li#li4").hide()},_getStateMarketMapPois:function(){$jq.ajax({url:this._mapStatesAction,data:{partnerId:this._partnerId,state:this._state},success:this._onStateMarketPoiSuccess.bind(this)})},_onStateMarketPoiSuccess:function(d){var a=d.getElementsByTagName("MapPoi");mqPoiCollection=new MQA.ShapeCollection;var b=a.length;for(i=0;i<b;i++){var h=this._getChildNodeValue(a[i],"Id"),f=this._getChildNodeValue(a[i],"Lat"),g=this._getChildNodeValue(a[i],"Lng"),e=this._getChildNodeValue(a[i],"Title"),c=new MQA.LatLng(f,g);mqPoint=new MQA.Poi(c,this._nhsMapIconMkt);mqPoint.setValue("iconOffset",new MQA.Point(-20,-37));mqPoint.setValue("shadow",this._nhsMapIconShadow);mqPoint.setValue("infoTitleHTML","<strong>"+e+"</strong>");mqPoint.setValue("key",h);MQA.EventManager.addListener(mqPoint,"click",this._clickPoint);mqPoiCollection.add(mqPoint)}this._nhsMqMap.replaceShapes(mqPoiCollection)},_clickPoint:function(){window.location.href="/communityresults/market-"+this.getKey()},_getChildNodeValue:function(a,b){if(a.getElementsByTagName(b)[0].childNodes.length>0)return a.getElementsByTagName(b)[0].childNodes[0].nodeValue;else return ""},_switchBoxDisplay:function(j,k,c,d,e){var i=j,l=document.getElementById(k),f=document.getElementById("li1"),g=document.getElementById("li2"),h=document.getElementById("li3"),b=document.getElementById("li4"),a=document.getElementById("nhs_StateBrowseDiv");if(i=="li1"){f.className="nhs_Selected";g.className=h.className="";if(b)b.className="";$jq("#"+c).hide();$jq("#"+d).hide();$jq("#"+e).hide();a.style.height="auto"}if(i=="li2"){g.className="nhs_Selected";f.className=h.className="";if(b)b.className="";$jq("#"+c).hide();$jq("#"+d).hide();$jq("#"+e).hide();a.style.height="auto";a.style.maxHeight="250px"}if(i=="li3"){h.className="nhs_Selected";f.className=g.className="";if(b)b.className="";$jq("#"+c).hide();$jq("#"+d).hide();$jq("#"+e).hide();a.style.height="auto";a.style.maxHeight="250px"}if(i=="li4"){b.className="nhs_Selected";f.className=g.className=h.className="";$jq("#"+c).hide();$jq("#"+d).hide();$jq("#"+e).hide();a.style.height="auto";a.style.maxHeight="250px"}l.style.display="inline"}}